# line nr: 23
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Optional(Pattern(~m, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Optional(Pattern(~n, Blank()))), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~m, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), EqQ(~A*Power(~b, 2) + ~C*Power(~a, 2) - ~B*~a*~b, 0))
  integrate((~B*~b + ~C*~b*tan(~e + ~f*~x) - ~C*~a)*Power(~a + ~b*tan(~e + ~f*~x), 1 + ~m)*Power(~c + ~d*tan(~e + ~f*~x), ~n), ~x)*Power(Power(~b, 2), -1)
end

# line nr: 29
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Optional(Pattern(~m, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Optional(Pattern(~n, Blank()))), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~m, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), EqQ(~A*Power(~b, 2) + ~C*Power(~a, 2), 0))
  -~C*integrate((~a - ~b*tan(~e + ~f*~x))*Power(~a + ~b*tan(~e + ~f*~x), 1 + ~m)*Power(~c + ~d*tan(~e + ~f*~x), ~n), ~x)*Power(Power(~b, 2), -1)
end

# line nr: 35
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Pattern(~A, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Optional(Pattern(~m, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Optional(Pattern(~n, Blank()))), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~m, ~n), ~x), EqQ(~A, ~C))
  ~A*Power(~f, -1)*Subst(integrate(Power(~a + ~b*~x, ~m)*Power(~c + ~d*~x, ~n), ~x), ~x, tan(~e + ~f*~x))
end

# line nr: 41
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())))*(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), LtQ(~n, -1))
  Power(~d*(Power(~c, 2) + Power(~d, 2)), -1)*integrate(Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Simp(~b*(~A*Power(~d, 2) + ~C*Power(~c, 2) - ~B*~c*~d) + ~a*~d*(~A*~c + ~B*~d - ~C*~c) + ~d*(~A*~b*~c + ~B*~a*~c + ~C*~a*~d + ~B*~b*~d - ~A*~a*~d - ~C*~b*~c)*tan(~e + ~f*~x) + ~C*~b*(Power(~c, 2) + Power(~d, 2))*Power(tan(~e + ~f*~x), 2), ~x), ~x) + (~a*~d - ~b*~c)*(~A*Power(~d, 2) + ~C*Power(~c, 2) - ~B*~c*~d)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~f*(1 + ~n)*(Power(~c, 2) + Power(~d, 2))*Power(~d, 2), -1)
end

# line nr: 49
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())))*(Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), LtQ(~n, -1))
  Power(~d*(Power(~c, 2) + Power(~d, 2)), -1)*integrate(Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Simp(~b*(~A*Power(~d, 2) + ~C*Power(~c, 2)) + ~a*~d*(~A*~c - ~C*~c) + ~d*(~A*~b*~c + ~C*~a*~d - ~A*~a*~d - ~C*~b*~c)*tan(~e + ~f*~x) + ~C*~b*(Power(~c, 2) + Power(~d, 2))*Power(tan(~e + ~f*~x), 2), ~x), ~x) + (~A*Power(~d, 2) + ~C*Power(~c, 2))*(~a*~d - ~b*~c)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~f*(1 + ~n)*(Power(~c, 2) + Power(~d, 2))*Power(~d, 2), -1)
end

# line nr: 57
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Pattern(~a, Blank()))*(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Optional(Pattern(~n, Blank()))), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), Not(LtQ(~n, -1)))
  ~C*~b*tan(~e + ~f*~x)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~d*~f*(2 + ~n), -1) - Power(~d*(2 + ~n), -1)*integrate(Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~C*~b*~c - (~C*~a*~d*(2 + ~n) - ~b*(~C*~c - ~B*~d*(2 + ~n)))*Power(tan(~e + ~f*~x), 2) - ~A*~a*~d*(2 + ~n) - ~d*(2 + ~n)*(~A*~b + ~B*~a - ~C*~b)*tan(~e + ~f*~x), ~x), ~x)
end

# line nr: 65
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Pattern(~a, Blank()))*(Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Optional(Pattern(~n, Blank()))), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), Not(LtQ(~n, -1)))
  ~C*~b*tan(~e + ~f*~x)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~d*~f*(2 + ~n), -1) - Power(~d*(2 + ~n), -1)*integrate(Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~C*~b*~c - (~C*~a*~d*(2 + ~n) - ~C*~b*~c)*Power(tan(~e + ~f*~x), 2) - ~A*~a*~d*(2 + ~n) - ~d*(2 + ~n)*(~A*~b - ~C*~b)*tan(~e + ~f*~x), ~x), ~x)
end

# line nr: 73
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Optional(Pattern(~n, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Pattern(~a, Blank()), Pattern(~m, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), EqQ(Power(~a, 2) + Power(~b, 2), 0), Or(LtQ(~m, 0), EqQ(1 + ~m + ~n, 0)))
  integrate(Power(~a + ~b*tan(~e + ~f*~x), 1 + ~m)*Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~a*(~B*~c*~m + ~C*~d*(1 + ~n) - ~A*~d*(1 + ~n + 2 * ~m)) + ~b*(~c*~m*(~A + ~C) - ~B*~d*(1 + ~n)) + (~a*(2 * ~C*~c*~m - ~B*~d*(1 + ~m + ~n)) + ~A*~b*~d*(1 + ~m + ~n) + ~C*~b*~d*(~m - 1 - ~n))*tan(~e + ~f*~x), ~x), ~x)*Power(2 * ~a*~m*(~b*~c - ~a*~d), -1) + (~A*~a + ~B*~b - ~C*~a)*Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(2 * ~f*~m*(~b*~c - ~a*~d), -1)
end

# line nr: 82
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Optional(Pattern(~n, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Pattern(~a, Blank()), Pattern(~m, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), EqQ(Power(~a, 2) + Power(~b, 2), 0), Or(LtQ(~m, 0), EqQ(1 + ~m + ~n, 0)))
  integrate(Power(~a + ~b*tan(~e + ~f*~x), 1 + ~m)*Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~a*(~C*~d*(1 + ~n) - ~A*~d*(1 + ~n + 2 * ~m)) + (~A*~b*~d*(1 + ~m + ~n) + ~C*~b*~d*(~m - 1 - ~n) + 2 * ~C*~a*~c*~m)*tan(~e + ~f*~x) + ~b*~c*~m*(~A + ~C), ~x), ~x)*Power(2 * ~a*~m*(~b*~c - ~a*~d), -1) + ~a*(~A - ~C)*Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(2 * ~f*~m*(~b*~c - ~a*~d), -1)
end

# line nr: 90
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Pattern(~a, Blank()), Optional(Pattern(~m, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~m), ~x), NeQ(~b*~c - ~a*~d, 0), EqQ(Power(~a, 2) + Power(~b, 2), 0), Not(LtQ(~m, 0)), LtQ(~n, -1), NeQ(Power(~c, 2) + Power(~d, 2), 0))
  (~A*Power(~d, 2) + ~C*Power(~c, 2) - ~B*~c*~d)*Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~d*~f*(1 + ~n)*(Power(~c, 2) + Power(~d, 2)), -1) - integrate(Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Simp(~b*~m*(~A*Power(~d, 2) + ~C*Power(~c, 2) - ~B*~c*~d) - ~a*(~d*(~B*~c - ~A*~d)*(1 + ~m + ~n) - ~C*(~m*Power(~c, 2) - (1 + ~n)*Power(~d, 2)))*tan(~e + ~f*~x) - ~a*~d*(1 + ~n)*(~A*~c + ~B*~d - ~C*~c), ~x), ~x)*Power(~a*~d*(1 + ~n)*(Power(~c, 2) + Power(~d, 2)), -1)
end

# line nr: 98
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Pattern(~a, Blank()), Optional(Pattern(~m, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~m), ~x), NeQ(~b*~c - ~a*~d, 0), EqQ(Power(~a, 2) + Power(~b, 2), 0), Not(LtQ(~m, 0)), LtQ(~n, -1), NeQ(Power(~c, 2) + Power(~d, 2), 0))
  (~A*Power(~d, 2) + ~C*Power(~c, 2))*Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~d*~f*(1 + ~n)*(Power(~c, 2) + Power(~d, 2)), -1) - integrate(Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Simp(~b*~m*(~A*Power(~d, 2) + ~C*Power(~c, 2)) - ~a*(-~C*(~m*Power(~c, 2) - (1 + ~n)*Power(~d, 2)) - ~A*(1 + ~m + ~n)*Power(~d, 2))*tan(~e + ~f*~x) - ~a*~d*(1 + ~n)*(~A*~c - ~C*~c), ~x), ~x)*Power(~a*~d*(1 + ~n)*(Power(~c, 2) + Power(~d, 2)), -1)
end

# line nr: 106
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Optional(Pattern(~n, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Pattern(~a, Blank()), Optional(Pattern(~m, Blank()))), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~m, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), EqQ(Power(~a, 2) + Power(~b, 2), 0), Not(LtQ(~m, 0)), NeQ(1 + ~m + ~n, 0))
  Power(~b*~d*(1 + ~m + ~n), -1)*integrate(Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~C*(~a*~c*~m - ~b*~d*(1 + ~n)) + ~A*~b*~d*(1 + ~m + ~n) - (~C*~m*(~b*~c - ~a*~d) - ~B*~b*~d*(1 + ~m + ~n))*tan(~e + ~f*~x), ~x), ~x) + ~C*Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~d*~f*(1 + ~m + ~n), -1)
end

# line nr: 114
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Optional(Pattern(~n, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Pattern(~a, Blank()), Optional(Pattern(~m, Blank()))), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~m, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), EqQ(Power(~a, 2) + Power(~b, 2), 0), Not(LtQ(~m, 0)), NeQ(1 + ~m + ~n, 0))
  Power(~b*~d*(1 + ~m + ~n), -1)*integrate(Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~C*(~a*~c*~m - ~b*~d*(1 + ~n)) + ~A*~b*~d*(1 + ~m + ~n) - ~C*~m*(~b*~c - ~a*~d)*tan(~e + ~f*~x), ~x), ~x) + ~C*Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~d*~f*(1 + ~m + ~n), -1)
end

# line nr: 122
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Pattern(~m, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), GtQ(~m, 0), LtQ(~n, -1))
  (~A*Power(~d, 2) + ~c*(~C*~c - ~B*~d))*Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~d*~f*(1 + ~n)*(Power(~c, 2) + Power(~d, 2)), -1) - Power(~d*(1 + ~n)*(Power(~c, 2) + Power(~d, 2)), -1)*integrate(Power(~a + ~b*tan(~e + ~f*~x), ~m - 1)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Simp((~C*~c - ~B*~d)*(~b*~c*~m + ~a*~d*(1 + ~n)) + ~A*~d*(~b*~d*~m - ~a*~c*(1 + ~n)) - ~b*(~d*(~B*~c - ~A*~d)*(1 + ~m + ~n) - ~C*(~m*Power(~c, 2) - (1 + ~n)*Power(~d, 2)))*Power(tan(~e + ~f*~x), 2) - ~d*(1 + ~n)*(~B*(~a*~c + ~b*~d) + (~A - ~C)*(~b*~c - ~a*~d))*tan(~e + ~f*~x), ~x), ~x)
end

# line nr: 132
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Pattern(~m, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), GtQ(~m, 0), LtQ(~n, -1))
  (~A*Power(~d, 2) + ~C*Power(~c, 2))*Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~d*~f*(1 + ~n)*(Power(~c, 2) + Power(~d, 2)), -1) - Power(~d*(1 + ~n)*(Power(~c, 2) + Power(~d, 2)), -1)*integrate(Power(~a + ~b*tan(~e + ~f*~x), ~m - 1)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Simp(~A*~d*(~b*~d*~m - ~a*~c*(1 + ~n)) + ~C*~c*(~b*~c*~m + ~a*~d*(1 + ~n)) + ~b*(~C*(~m*Power(~c, 2) - (1 + ~n)*Power(~d, 2)) + ~A*(1 + ~m + ~n)*Power(~d, 2))*Power(tan(~e + ~f*~x), 2) - ~d*(1 + ~n)*(~A - ~C)*(~b*~c - ~a*~d)*tan(~e + ~f*~x), ~x), ~x)
end

# line nr: 142
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Optional(Pattern(~m, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), GtQ(~m, 0), Not(And(IGtQ(~n, 0), Or(Not(IntegerQ(~m)), And(EqQ(~c, 0), NeQ(~a, 0))))))
  Power(~d*(1 + ~m + ~n), -1)*integrate(Power(~a + ~b*tan(~e + ~f*~x), ~m - 1)*Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~A*~a*~d*(1 + ~m + ~n) + ~d*(1 + ~m + ~n)*(~A*~b + ~B*~a - ~C*~b)*tan(~e + ~f*~x) - ~C*(~b*~c*~m + ~a*~d*(1 + ~n)) - (~C*~m*(~b*~c - ~a*~d) - ~B*~b*~d*(1 + ~m + ~n))*Power(tan(~e + ~f*~x), 2), ~x), ~x) + ~C*Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~d*~f*(1 + ~m + ~n), -1)
end

# line nr: 151
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Optional(Pattern(~m, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), GtQ(~m, 0), Not(And(IGtQ(~n, 0), Or(Not(IntegerQ(~m)), And(EqQ(~c, 0), NeQ(~a, 0))))))
  Power(~d*(1 + ~m + ~n), -1)*integrate(Power(~a + ~b*tan(~e + ~f*~x), ~m - 1)*Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~A*~a*~d*(1 + ~m + ~n) + ~d*(~A*~b - ~C*~b)*(1 + ~m + ~n)*tan(~e + ~f*~x) - ~C*(~b*~c*~m + ~a*~d*(1 + ~n)) - ~C*~m*(~b*~c - ~a*~d)*Power(tan(~e + ~f*~x), 2), ~x), ~x) + ~C*Power(~a + ~b*tan(~e + ~f*~x), ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~d*~f*(1 + ~m + ~n), -1)
end

# line nr: 160
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Pattern(~m, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), LtQ(~m, -1), Not(And(ILtQ(~n, -1), Or(Not(IntegerQ(~m)), And(EqQ(~c, 0), NeQ(~a, 0))))))
  Power((1 + ~m)*(~b*~c - ~a*~d)*(Power(~a, 2) + Power(~b, 2)), -1)*integrate(Power(~a + ~b*tan(~e + ~f*~x), 1 + ~m)*Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~A*(~a*(1 + ~m)*(~b*~c - ~a*~d) - ~d*(2 + ~m + ~n)*Power(~b, 2)) + (~B*~b - ~C*~a)*(~b*~c*(1 + ~m) + ~a*~d*(1 + ~n)) - ~d*(~A*Power(~b, 2) - ~a*(~B*~b - ~C*~a))*(2 + ~m + ~n)*Power(tan(~e + ~f*~x), 2) - (1 + ~m)*(~b*~c - ~a*~d)*(~A*~b - ~B*~a - ~C*~b)*tan(~e + ~f*~x), ~x), ~x) + (~A*Power(~b, 2) - ~a*(~B*~b - ~C*~a))*Power(~a + ~b*tan(~e + ~f*~x), 1 + ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~f*(1 + ~m)*(~b*~c - ~a*~d)*(Power(~a, 2) + Power(~b, 2)), -1)
end

# line nr: 171
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Pattern(~m, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), LtQ(~m, -1), Not(And(ILtQ(~n, -1), Or(Not(IntegerQ(~m)), And(EqQ(~c, 0), NeQ(~a, 0))))))
  Power((1 + ~m)*(~b*~c - ~a*~d)*(Power(~a, 2) + Power(~b, 2)), -1)*integrate(Power(~a + ~b*tan(~e + ~f*~x), 1 + ~m)*Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~A*(~a*(1 + ~m)*(~b*~c - ~a*~d) - ~d*(2 + ~m + ~n)*Power(~b, 2)) - ~C*~a*(~b*~c*(1 + ~m) + ~a*~d*(1 + ~n)) - ~d*(~A*Power(~b, 2) + ~C*Power(~a, 2))*(2 + ~m + ~n)*Power(tan(~e + ~f*~x), 2) - (1 + ~m)*(~A*~b - ~C*~b)*(~b*~c - ~a*~d)*tan(~e + ~f*~x), ~x), ~x) + (~A*Power(~b, 2) + ~C*Power(~a, 2))*Power(~a + ~b*tan(~e + ~f*~x), 1 + ~m)*Power(~c + ~d*tan(~e + ~f*~x), 1 + ~n)*Power(~f*(1 + ~m)*(~b*~c - ~a*~d)*(Power(~a, 2) + Power(~b, 2)), -1)
end

# line nr: 182
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Pattern(~a, Blank()))*(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank()))), -1), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0))
  (~A*Power(~b, 2) + ~C*Power(~a, 2) - ~B*~a*~b)*integrate((~b - ~a*tan(~e + ~f*~x))*Power(~a + ~b*tan(~e + ~f*~x), -1), ~x)*Power((~b*~c - ~a*~d)*(Power(~a, 2) + Power(~b, 2)), -1) + ~x*(~b*(~B*~c + ~C*~d - ~A*~d) + ~a*(~A*~c + ~B*~d - ~C*~c))*Power((Power(~a, 2) + Power(~b, 2))*(Power(~c, 2) + Power(~d, 2)), -1) - (~A*Power(~d, 2) + ~C*Power(~c, 2) - ~B*~c*~d)*integrate((~d - ~c*tan(~e + ~f*~x))*Power(~c + ~d*tan(~e + ~f*~x), -1), ~x)*Power((~b*~c - ~a*~d)*(Power(~c, 2) + Power(~d, 2)), -1)
end

# line nr: 190
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Pattern(~a, Blank()))*(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank()))), -1), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0))
  ~x*(~a*(~A*~c - ~C*~c) - ~b*(~A*~d - ~C*~d))*Power((Power(~a, 2) + Power(~b, 2))*(Power(~c, 2) + Power(~d, 2)), -1) + (~A*Power(~b, 2) + ~C*Power(~a, 2))*integrate((~b - ~a*tan(~e + ~f*~x))*Power(~a + ~b*tan(~e + ~f*~x), -1), ~x)*Power((~b*~c - ~a*~d)*(Power(~a, 2) + Power(~b, 2)), -1) - (~A*Power(~d, 2) + ~C*Power(~c, 2))*integrate((~d - ~c*tan(~e + ~f*~x))*Power(~c + ~d*tan(~e + ~f*~x), -1), ~x)*Power((~b*~c - ~a*~d)*(Power(~c, 2) + Power(~d, 2)), -1)
end

# line nr: 198
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), -1)*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), Not(GtQ(~n, 0)), Not(LeQ(~n, -1)))
  Power(Power(~a, 2) + Power(~b, 2), -1)*integrate(Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~B*~b + ~a*(~A - ~C) + (~B*~a - ~b*(~A - ~C))*tan(~e + ~f*~x), ~x), ~x) + (~A*Power(~b, 2) + ~C*Power(~a, 2) - ~B*~a*~b)*Power(Power(~a, 2) + Power(~b, 2), -1)*integrate((1 + Power(tan(~e + ~f*~x), 2))*Power(~a + ~b*tan(~e + ~f*~x), -1)*Power(~c + ~d*tan(~e + ~f*~x), ~n), ~x)
end

# line nr: 205
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), -1)*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0), Not(GtQ(~n, 0)), Not(LeQ(~n, -1)))
  Power(Power(~a, 2) + Power(~b, 2), -1)*integrate(Power(~c + ~d*tan(~e + ~f*~x), ~n)*Simp(~a*(~A - ~C) - (~A*~b - ~C*~b)*tan(~e + ~f*~x), ~x), ~x) + (~A*Power(~b, 2) + ~C*Power(~a, 2))*Power(Power(~a, 2) + Power(~b, 2), -1)*integrate((1 + Power(tan(~e + ~f*~x), 2))*Power(~a + ~b*tan(~e + ~f*~x), -1)*Power(~c + ~d*tan(~e + ~f*~x), ~n), ~x)
end

# line nr: 212
@rule integrate((tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~B, Blank())) + Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Pattern(~m, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~B, ~C, ~m, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0))
  With(List(Set(~ff, FreeFactors(tan(~e + ~f*~x), ~x))), ~ff*Power(~f, -1)*Subst(integrate((~A + ~B*~ff*~x + ~C*Power(~ff, 2)*Power(~x, 2))*Power(1 + Power(~ff, 2)*Power(~x, 2), -1)*Power(~a + ~b*~ff*~x, ~m)*Power(~c + ~d*~ff*~x, ~n), ~x), ~x, tan(~e + ~f*~x)*Power(~ff, -1)))
end

# line nr: 219
@rule integrate((Optional(Pattern(~C, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank()))), 2) + Optional(Pattern(~A, Blank())))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~b, Blank())) + Optional(Pattern(~a, Blank())), Pattern(~m, Blank()))*Power(tan(Optional(Pattern(~f, Blank()))*Pattern(~x, Blank()) + Optional(Pattern(~e, Blank())))*Optional(Pattern(~d, Blank())) + Optional(Pattern(~c, Blank())), Pattern(~n, Blank())), Pattern(~x, Blank(~Symbol))) => if And(FreeQ(List(~a, ~b, ~c, ~d, ~e, ~f, ~A, ~C, ~m, ~n), ~x), NeQ(~b*~c - ~a*~d, 0), NeQ(Power(~a, 2) + Power(~b, 2), 0), NeQ(Power(~c, 2) + Power(~d, 2), 0))
  With(List(Set(~ff, FreeFactors(tan(~e + ~f*~x), ~x))), ~ff*Power(~f, -1)*Subst(integrate((~A + ~C*Power(~ff, 2)*Power(~x, 2))*Power(1 + Power(~ff, 2)*Power(~x, 2), -1)*Power(~a + ~b*~ff*~x, ~m)*Power(~c + ~d*~ff*~x, ~n), ~x), ~x, tan(~e + ~f*~x)*Power(~ff, -1)))
end

